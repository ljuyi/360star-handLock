function initPoint(){for(var t=0;t<oLi.length;t++)oLi[t].className="";ctx.clearRect(0,0,canvas.width,canvas.height),route.input=[]}function Point(){this.x=arguments[0]||0,this.y=arguments[0]||0}function paintLine(){ctx.clearRect(0,0,canvas.width,canvas.height);for(var t=0;t<route.input.length-1;t++)ctx.beginPath(),ctx.moveTo(oLi[route.input[t]].offsetLeft+18,oLi[route.input[t]].offsetTop+18),ctx.lineTo(oLi[route.input[t+1]].offsetLeft+18,oLi[route.input[t+1]].offsetTop+18),ctx.strokeStyle="#E57679",ctx.strokeWidth="0.1rem",ctx.closePath(),ctx.stroke()}function paintEndLine(t){ctx.clearRect(0,0,canvas.width,canvas.height),paintLine(),ctx.beginPath(),ctx.moveTo(oLi[route.input[route.input.length-1]].offsetLeft+18,oLi[route.input[route.input.length-1]].offsetTop+18),ctx.lineTo(t.x,t.y),ctx.strokeStyle="#E57679",ctx.strokeWidth="0.1rem",ctx.closePath(),ctx.stroke()}function switchCase(t){route.input.indexOf(t)<0&&(route.input.push(t),oLi[t].className="active",paintLine())}function touch(t){var t=t||window.event,e=t.srcElement?t.srcElement:t.target;switch(t.type){case"touchstart":initPoint(),e.className="active",route.input.push(e.index);break;case"touchmove":var i=new Point;switch(i.x=parseInt(t.changedTouches[0].clientX),i.y=parseInt(t.changedTouches[0].clientY-oHeader.offsetHeight),!0){case i.x>=oLi[0].x&&i.x<=oLi[0].x+36&&i.y>=oLi[0].y&&i.y<=oLi[0].y+36:switchCase(0);break;case i.x>=oLi[1].x&&i.x<=oLi[1].x+36&&i.y>=oLi[1].y&&i.y<=oLi[1].y+36:switchCase(1);break;case i.x>=oLi[2].x&&i.x<=oLi[2].x+36&&i.y>=oLi[2].y&&i.y<=oLi[2].y+36:switchCase(2);break;case i.x>=oLi[3].x&&i.x<=oLi[3].x+36&&i.y>=oLi[3].y&&i.y<=oLi[3].y+36:switchCase(3);break;case i.x>=oLi[4].x&&i.x<=oLi[4].x+36&&i.y>=oLi[4].y&&i.y<=oLi[4].y+36:switchCase(4);break;case i.x>=oLi[5].x&&i.x<=oLi[5].x+36&&i.y>=oLi[5].y&&i.y<=oLi[5].y+36:switchCase(5);break;case i.x>=oLi[6].x&&i.x<=oLi[6].x+36&&i.y>=oLi[6].y&&i.y<=oLi[6].y+36:switchCase(6);break;case i.x>=oLi[7].x&&i.x<=oLi[7].x+36&&i.y>=oLi[7].y&&i.y<=oLi[7].y+36:switchCase(7);break;case i.x>=oLi[8].x&&i.x<=oLi[8].x+36&&i.y>=oLi[8].y&&i.y<=oLi[8].y+36:switchCase(8);break;default:paintEndLine(i)}t.preventDefault();break;case"touchend":route.isCheck?route.input.toString()==localStorage.getItem("psd").toString()?info.innerHTML="<p>密码正确!</p>":(info.innerHTML="<p>输入的密码不正确</p>",initPoint()):route.input.length<5?(info.innerHTML="<p>密码太短，至少需要5个点</p>",initPoint()):0==firstSet.length?(firstSet=route.input.slice(0),info.innerHTML="<p>请再次输入手势密码</p>",initPoint()):0!=firstSet.length&&(firstSet.toString()==route.input.toString()?(info.innerHTML="<p>密码设置成功</p>",localStorage.setItem("psd",route.input),firstSet=[],initPoint()):(info.innerHTML="<p>两次输入的不一致</p>",firstSet=[],initPoint()))}}var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),oHeader=document.getElementById("header"),oDiv=document.getElementById("body"),info=document.getElementById("info"),oLabel=document.getElementById("select").getElementsByTagName("label"),check=document.getElementById("check"),oLi=oDiv.getElementsByTagName("li"),firstSet=[],route={input:[],isCheck:!0};check.checked=!0;for(var i=0;i<oLi.length;i++)oLi[i].addEventListener("touchstart",touch,!1),oLi[i].addEventListener("touchmove",touch,!1),oLi[i].addEventListener("touchend",touch,!1),oLi[i].index=i,oLi[i].x=oLi[i].offsetLeft,oLi[i].y=oLi[i].offsetTop;oLabel[0].onclick=function(){route.isCheck=!1,initPoint()},oLabel[1].onclick=function(){route.isCheck=!0,initPoint()},localStorage.setItem("psd",[0,1,2,4,6,7,8]);